generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String
  nom       String
  prenom    String
  role      String   @default("USER") // ADMIN, USER, MANAGER
  actif     Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([email])
  @@index([role])
}

model Fournisseur {
  id                    String    @id @default(uuid())
  codeFournisseur       String    @unique
  raisonSociale         String
  siret                 String?
  tvaIntracommunautaire String?
  codeApeNaf            String?
  formeJuridique        String?
  capitalSocial         Decimal?  @db.Decimal(18, 2)
  adresseSiege          String?
  adresseLivraison      String?
  plafondCredit         Decimal?  @db.Decimal(18, 2)
  devise                String    @default("EUR")
  estSousTraitant       Boolean   @default(false)
  pasDeTvaGuyane        Boolean   @default(false)
  compteComptable       String?
  createdAt             DateTime  @default(now())
  
  // Relations
  contacts              Contact[]
  
  @@index([codeFournisseur])
  @@index([siret])
}

model Contact {
  id             String      @id @default(uuid())
  fournisseurId  String
  nom            String
  prenom         String?
  email          String?
  telephone      String?
  fonction       String?
  createdAt      DateTime    @default(now())
  
  // Relations
  fournisseur    Fournisseur @relation(fields: [fournisseurId], references: [id], onDelete: Cascade)
  
  @@index([fournisseurId])
}

model PlanComptable {
  id           String        @id @default(uuid())
  numeroCompte String        @unique
  intitule     String
  typeCompte   String        @default("FOURNISSEUR")
  createdAt    DateTime      @default(now())
  
  @@index([numeroCompte])
  @@index([typeCompte])
}

model ConditionsPaiement {
  id          String   @id @default(uuid())
  libelle     String   @unique
  delai       Int      @default(0)
  description String?
  actif       Boolean  @default(true)
  createdAt   DateTime @default(now())
  
  @@index([libelle])
  @@index([actif])
}
